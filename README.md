Writeup for CMPE 283 Assignment 1

Steps undertaken for Assignment 1:
Installed VMWare workstation player 16 on my windows machine.
Downloaded ubuntu OS installer iso/disk image file
Installed Image on Workstation player
Installed git on Ubuntu VM
Set permissions to grant superuser access to default user profile
Downloaded relevant course files on VM
Changed ownership of fork-cloned linux file and downloaded course files (.c file and makefile) to default user
Realized that nested virtualization was not enabled on VM
Did a lot of research on trying to narrow down why the VM controls were not being enabled on the VMware workstation Player and Windows 10
Learned that it was because of Hyper-V modules installed in windows 10. Ran the command “bcdedit /set hypervisorlaunchtype off” in powershell in admin mode to resolve the issue. (VMWare Customer Connect, 2020)
Re-enabled VMX controls for VM in Workstation Player. It was done using “Player> Manage> Virtual Machine Settings> Processors> Check “Virtualize Intel VT-x/EPT or AMD-V/RVI”
Verified whether virtualization was enabled in the VM environment by calling “lscpu” command on the VM terminal.
Went through and tried to understand the “cmpe283-1.c” file.
Installed gcc and vim to make processing/coding the “cmpe283-1.c” file easier.
Tried to build the make file as suggested in the assignment video.
Went ahead and tried to install
Installed libssl-dev, libelf, libdwarf, and a few more tools using the “sudo apt-get install” commands over the course of the build process. I used the fatal errors to determine which exact packets were missing. I remember there used to be a command in linux to auto-install all missing packets and tools required for a build/process but have forgotten what it was.
Tweaked the copied linux config files from boot into linux directory to modify certificate checks as it was causing build errors in the kernel make and/or module make commands ("Agora" & "slm", n.d.). Had to remove certain attributes and comment out some lines referencing debian certificates which were not installed. This caused the build to generate new certificates which resolved the issue. The certificates seemed to be generated by/using the x509 protocol.
Resolved various errors that arose in the linux make process such as the absence of “dwarves” by installing “dwarves” into the VM. I initially thought this “pahole” issue would be resolved using the “libdwarf” install but was wrong.
Called the make command various times on the linux build. This took up a lot of the time as each build, even with 4 processors working on it simultaneously, would take at least an hour or so to complete. At this point, the modules have been successfully made, the oldconfig has been made (with default answers to all config questions by pressing enter instead of “y/n”), the prepare file has been made and tried, the provided makeFile has been made. The recurring issue lies when trying to make the linux kernel file within the fork-clone directory.
Called “sudo make INSTALL_MOD_STRIP=1 modules_install” to collect all modules and repackage them into the lib folder for easier deployment. This also ensures that the debug info is stripped so that the file size is substantially reduced.
Called “sudo make install” to finally build the kernel
Used “sudo reboot” to reboot the machine and run the latest kernel on VM
Called “make” again in the directory preceding the linux directory. It ran into the same issue as the one seen in the assignment 1 video. Installed module licenses by adding the “MODULE_LICENSE(“GPL v2”);” statement to the cmpe283-1.c file.
Successfully created the kernel object and then called “sudo insmod cmpe283-1.ko”.
Verified that the kernel object was loaded successfully using the “lsmod | grep cmpe283” command
Called dmesg to get the following output: <Image missing; was inserted in google doc>
Made a cmpe283 directory inside the linux folder and stored the final versions of the Makefile and cmpe283-1.c files in it. Committed the changes (i.e. addition of both files) to the local repo. Generated the personal token on github, logged in and entered the personal token as the password to push the changes to github repo. The protocol involving the personal token has been made mandatory since August 13, 2021 and was not mentioned in the assignment instruction video (just a heads up for the next semester classes!).



References
"Agora", & "slm". (n.d.). Attempting to compile kernel yields a certification error - Unix & Linux Stack Exchange. Unix StackExchange. Retrieved November 10, 2021, from https://unix.stackexchange.com/questions/293642/attempting-to-compile-kernel-yields-a-certification-error
VMWare Customer Connect. (2020, September 9). "VMware Workstation and Device/Credential Guard are not compatible" error in VMware Workstation on Windows 10 host (2146361) | VMware KB. VMware Knowledge Base. Retrieved November 10, 2021, from https://kb.vmware.com/s/article/2146361

